## Описание

Микросервис на Go, который предоставляет три сервиса: создание пользователя, авторизация пользователя и предоставление данных о продукте.
Для маршрутизации HTTP-запросов выбрала фреймворк Gorilla Mux. 
Для работы с базой данных PostgreSQL использовала ORM GORM. 
Для генерации и валидации JWT токенов использовала библиотеку dgrijalva/jwt-go.

## Запуск

### Локально

1. Установите Go 1.20+
2. Запустите PostgreSQL
3. Настройте переменные окружения в .env файле
4. Запустите сервис:

```
go run main.go
```

### В Docker
Установите Docker и Docker Compose
Запустите сервис:
```
docker-compose up --build
```
### Testing:
Создание пользователя:
```
curl -X POST -H "Content-Type: application/json" -d '{"username":"testuser", "password":"testpassword"}' http://localhost:8080/user
```
Авторизация пользователя:
```
TOKEN=$(curl -s -X POST -H "Content-Type: application/json" -d '{"username":"testuser", "password":"testpassword"}' http://localhost:8080/login | jq -r '.token')
echo $TOKEN
```
Получение данных о продукте:
```
curl -H "Authorization: Bearer $TOKEN" http://localhost:8080/product/productname
```

### Спецификация
###  1. Сервис создания пользователя
URL: /user

Метод: POST

Описание: Этот сервис позволяет создать нового пользователя. Принимает на вход два обязательных параметра: имя пользователя и пароль. Если пользователь с таким именем уже существует, возвращает ошибку. Если пользователя с таким именем нет, сохраняет его в базе данных и возвращает успешный статус.

Параметры запроса:
username (string): Имя пользователя. Обязательное поле.
password (string): Пароль пользователя. Обязательное поле.

Примеры запроса:
```
{
    "username": "testuser",
    "password": "testpassword"
}
```
Коды ответов:

201 Created: Пользователь успешно создан.
400 Bad Request: Неверный формат данных запроса.
409 Conflict: Пользователь с таким именем уже существует.
Примеры ответа:
```
{
    "message": "User created successfully."
}
```
### 2. Сервис авторизации пользователя
URL: /login

Метод: POST

Описание: Этот сервис позволяет авторизовать пользователя. Принимает на вход два обязательных параметра: имя пользователя и пароль. Если имя пользователя и пароль совпадают с данными в базе данных, генерирует и возвращает JWT токен, который валиден в течение 15 минут.

Параметры запроса:
```
username (string): Имя пользователя. Обязательное поле.
password (string): Пароль пользователя. Обязательное поле.
```
Примеры запроса:
```
{
    "username": "testuser",
    "password": "testpassword"
}
```
Коды ответов:

200 OK: Успешная авторизация. Возвращает JWT токен.
400 Bad Request: Неверный формат данных запроса.
401 Unauthorized: Неверное имя пользователя или пароль.

Примеры ответа:

```
{
    "token": "your.jwt.token.here"
}
```
### 3. Сервис получения данных о продукте
URL: /product/{name}

Метод: GET

Описание: Этот сервис позволяет получить данные о продукте по его названию. Требует наличия валидного Bearer токена в заголовке запроса. Если токен валиден, сервис ищет продукт с указанным названием в базе данных и возвращает его данные. Если продукт не найден, возвращает ошибку.

Параметры запроса:
```
name (string): Название продукта. 
```
Обязательное поле, указывается в URL.

Заголовки запроса:
```
Authorization (string): Bearer токен.
```
Обязательный заголовок.

Примеры запроса:
```
GET /product/productname
Authorization: Bearer your.jwt.token.here
```
Коды ответов:
200 OK: Продукт найден и данные успешно возвращены.
401 Unauthorized: Токен отсутствует или невалиден.
404 Not Found: Продукт с указанным названием не найден.
Примеры ответа:
```
{
    "id": 1,
    "name": "productname",
    "description": "Description of the product",
    "price": 19.99
}
```
### Примечание:
Все запросы и ответы должны быть в формате JSON.
Для всех защищённых эндпоинтов необходимо включать заголовок Authorization с валидным JWT токеном.
Продукты добавляются в базу данных вручную администратором через прямой доступ к базе данных. Пример команды для вставки продукта в PostgreSQL:
```
INSERT INTO products (name, description, price) VALUES ('productname', 'Description of the product', 19.99);
```
